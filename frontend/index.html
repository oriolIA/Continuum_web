<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Continuum Web - Wind Flow Model</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-animation">
        <div class="wave wave1"></div>
        <div class="wave wave2"></div>
        <div class="wave wave3"></div>
    </div>

    <!-- Top Navigation Bar -->
    <nav class="top-nav">
        <div class="nav-brand">
            <i class="fas fa-wind"></i>
            <span>Continuum</span>
        </div>
        
        <ul class="nav-menu">
            <li class="nav-item dropdown">
                <a href="#"><i class="fas fa-file"></i> Projecte</a>
                <div class="dropdown-content">
                    <a href="#" onclick="showNewProjectModal()"><i class="fas fa-plus"></i> Nou Projecte</a>
                    <a href="#" onclick="openProject()"><i class="fas fa-folder-open"></i> Obrir Projecte</a>
                    <a href="#" onclick="saveProject()"><i class="fas fa-save"></i> Guardar</a>
                    <div class="divider"></div>
                    <a href="#" onclick="closeProject()"><i class="fas fa-times"></i> Tancar</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a href="#"><i class="fas fa-tools"></i> Eines</a>
                <div class="dropdown-content">
                    <a href="#" onclick="runMetFilter()"><i class="fas fa-filter"></i> Filtratge Met</a>
                    <a href="#" onclick="runMCP()"><i class="fas fa-project-diagram"></i> MCP</a>
                    <a href="#" onclick="runWake()"><i class="fas fa-wind"></i> Wake</a>
                    <div class="divider"></div>
                    <a href="#" onclick="downloadReanalysis()"><i class="fas fa-cloud-download-alt"></i> Reanalysis</a>
                </div>
            </li>
            <li class="nav-item dropdown">
                <a href="#"><i class="fas fa-help-circle"></i> Ajuda</a>
                <div class="dropdown-content">
                    <a href="#"><i class="fas fa-question-circle"></i> Manual</a>
                    <a href="#"><i class="fas fa-info-circle"></i> Versió 2.1</a>
                </div>
            </li>
        </ul>
        
        <div class="nav-actions">
            <div class="project-status" id="project-status">
                <i class="fas fa-folder"></i>
                <span id="current-project-name">Sense projecte</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="content">
        <!-- Welcome Screen (no project) -->
        <div id="welcome-screen" class="welcome-screen">
            <div class="welcome-card glass">
                <i class="fas fa-wind fa-4x"></i>
                <h1>Continuum Web</h1>
                <p class="subtitle">Wind Resource Toolkit</p>
                
                <div class="welcome-actions">
                    <button class="primary-btn large" onclick="showNewProjectModal()">
                        <i class="fas fa-plus"></i>
                        Nou Projecte
                    </button>
                    <button class="secondary-btn large" onclick="openProject()">
                        <i class="fas fa-folder-open"></i>
                        Obrir Projecte
                    </button>
                </div>
                
                <div class="recent-projects">
                    <h3>Projectes recents</h3>
                    <div id="recent-list"></div>
                </div>
            </div>
        </div>

        <!-- Project Dashboard (with project) -->
        <div id="project-dashboard" class="project-dashboard hidden">
            
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div class="project-info">
                    <h1 id="dashboard-project-name">Projecte</h1>
                    <p id="dashboard-project-desc"></p>
                </div>
                <div class="dashboard-actions">
                    <button class="primary-btn" onclick="saveProject()">
                        <i class="fas fa-save"></i> Guardar
                    </button>
                </div>
            </div>

            <!-- Quick Actions Grid -->
            <div class="quick-actions">
                <div class="action-card glass" onclick="switchTab('input')">
                    <i class="fas fa-file-import fa-2x"></i>
                    <h3>Dades d'Entrada</h3>
                    <p>Met, Turbines, Topografia</p>
                </div>
                
                <div class="action-card glass" onclick="switchTab('met-qc')">
                    <i class="fas fa-filter fa-2x"></i>
                    <h3>Filtratge QC</h3>
                    <p>Ombra, Gel, STD</p>
                </div>
                
                <div class="action-card glass" onclick="switchTab('mcp')">
                    <i class="fas fa-project-diagram fa-2x"></i>
                    <h3>MCP</h3>
                    <p>Correlació Long-Term</p>
                </div>
                
                <div class="action-card glass" onclick="switchTab('wake')">
                    <i class="fas fa-wind fa-2x"></i>
                    <h3>Wake</h3>
                    <p>Pèrdues per Wake</p>
                </div>
                
                <div class="action-card glass" onclick="switchTab('layout')">
                    <i class="fas fa-th fa-2x"></i>
                    <h3>Layout</h3>
                    <p>Disseny Parc</p>
                </div>
                
                <div class="action-card glass" onclick="switchTab('results')">
                    <i class="fas fa-chart-bar fa-2x"></i>
                    <h3>Resultats</h3>
                    <p>AEP, Excedència</p>
                </div>
            </div>

            <!-- Tab Content -->
            <div class="tab-container">
                <!-- INPUT TAB -->
                <section id="tab-input" class="tab-content">
                    <h2><i class="fas fa-file-import"></i> Dades d'Entrada</h2>
                    
                    <div class="upload-grid">
                        <!-- Met Data -->
                        <div class="upload-card glass">
                            <div class="upload-icon">
                                <i class="fas fa-temperature-high"></i>
                            </div>
                            <h3>Dades Met</h3>
                            <p class="format-info">Formats: .TAB, .CSV, .TXT</p>
                            <input type="file" id="met-file" accept=".tab,.csv,.txt" multiple hidden>
                            <button class="primary-btn" onclick="document.getElementById('met-file').click()">
                                <i class="fas fa-upload"></i> Pujar
                            </button>
                            <div class="file-list" id="met-files-list"></div>
                        </div>

                        <!-- Turbines -->
                        <div class="upload-card glass">
                            <div class="upload-icon">
                                <i class="fas fa-fan"></i>
                            </div>
                            <h3>Turbines</h3>
                            <p class="format-info">Formats: .CSV, .TXT</p>
                            <input type="file" id="turbine-file" accept=".csv,.txt" multiple hidden>
                            <button class="primary-btn" onclick="document.getElementById('turbine-file').click()">
                                <i class="fas fa-upload"></i> Pujar
                            </button>
                            <div class="file-list" id="turbine-files-list"></div>
                        </div>

                        <!-- Topografia -->
                        <div class="upload-card glass">
                            <div class="upload-icon">
                                <i class="fas fa-mountain"></i>
                            </div>
                            <h3>Topografia</h3>
                            <p class="format-info">Formats: .TIF, .ADF, .MAP</p>
                            <input type="file" id="topo-file" accept=".tif,.tiff,.adf,.map" hidden>
                            <button class="primary-btn" onclick="document.getElementById('topo-file').click()">
                                <i class="fas fa-upload"></i> Pujar
                            </button>
                            <div class="file-list" id="topo-files-list"></div>
                        </div>

                        <!-- Land Cover -->
                        <div class="upload-card glass">
                            <div class="upload-icon">
                                <i class="fas fa-tree"></i>
                            </div>
                            <h3>Land Cover</h3>
                            <p class="format-info">Formats: .TIF, .TIFF</p>
                            <input type="file" id="lc-file" accept=".tif,.tiff" hidden>
                            <button class="primary-btn" onclick="document.getElementById('lc-file').click()">
                                <i class="fas fa-upload"></i> Pujar
                            </button>
                            <div class="file-list" id="lc-files-list"></div>
                        </div>
                    </div>
                </section>

                <!-- MET QC TAB -->
                <section id="tab-met-qc" class="tab-content">
                    <h2><i class="fas fa-filter"></i> Filtratge de Dades Met</h2>
                    
                    <div class="qc-panel glass">
                        <h3>Filtres disponibles</h3>
                        <div class="filter-options">
                            <label class="toggle-option">
                                <input type="checkbox" id="filter-tower" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-label">Ombra de Torre</span>
                            </label>
                            <label class="toggle-option">
                                <input type="checkbox" id="filter-ice" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-label">Detecció de Gel</span>
                            </label>
                            <label class="toggle-option">
                                <input type="checkbox" id="filter-std" checked>
                                <span class="toggle-slider"></span>
                                <span class="toggle-label">Filtre STD</span>
                            </label>
                        </div>
                        
                        <div class="action-row">
                            <button class="primary-btn large" onclick="runMetQC()">
                                <i class="fas fa-play"></i> Executar Filtratge
                            </button>
                        </div>
                        
                        <div class="results-panel" id="qc-results">
                            <p class="placeholder">Els resultats apareixeran aquí</p>
                        </div>
                    </div>
                </section>

                <!-- WAKE TAB -->
                <section id="tab-wake" class="tab-content">
                    <h2><i class="fas fa-wind"></i> Modelat de Wake</h2>
                    
                    <div class="wake-panel glass">
                        <div class="input-row">
                            <div class="input-group">
                                <label>Model</label>
                                <select id="wake-model">
                                    <option value="jensen">Jensen</option>
                                    <option value="larsen">Larsen</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Resolució Grid (m)</label>
                                <input type="number" id="wake-resolution" value="50">
                            </div>
                        </div>
                        
                        <div class="action-row">
                            <button class="primary-btn large" onclick="runWakeCalculation()">
                                <i class="fas fa-calculator"></i> Calcular Pèrdues
                            </button>
                        </div>
                        
                        <div class="results-panel" id="wake-results">
                            <p class="placeholder">Els resultats apareixeran aquí</p>
                        </div>
                    </div>
                </section>

                <!-- MCP TAB -->
                <section id="tab-mcp" class="tab-content">
                    <h2><i class="fas fa-project-diagram"></i> Measure-Correlate-Predict</h2>
                    
                    <div class="mcp-panel glass">
                        <div class="input-row">
                            <div class="input-group">
                                <label>Mètode</label>
                                <select id="mcp-method">
                                    <option value="orthogonal">Regressió Ortogonal</option>
                                    <option value="bins">Mètode de Bins</option>
                                    <option value="matrix">Matrix-LastWS</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Sectors</label>
                                <input type="number" id="mcp-sectors" value="12">
                            </div>
                        </div>
                        
                        <div class="action-row">
                            <button class="primary-btn large" onclick="runMCPCalculation()">
                                <i class="fas fa-calculator"></i> Executar MCP
                            </button>
                        </div>
                        
                        <div class="results-panel" id="mcp-results">
                            <p class="placeholder">Els resultats apareixeran aquí</p>
                        </div>
                    </div>
                </section>

                <!-- LAYOUT TAB -->
                <section id="tab-layout" class="tab-content">
                    <h2><i class="fas fa-th"></i> Disseny de Layout</h2>
                    
                    <div class="layout-panel glass">
                        <div class="input-row">
                            <div class="input-group">
                                <label>Files</label>
                                <input type="number" id="layout-rows" value="4">
                            </div>
                            <div class="input-group">
                                <label>Columnes</label>
                                <input type="number" id="layout-cols" value="5">
                            </div>
                            <div class="input-group">
                                <label>Espaiat X (m)</label>
                                <input type="number" id="layout-spacing-x" value="800">
                            </div>
                            <div class="input-group">
                                <label>Espaiat Y (m)</label>
                                <input type="number" id="layout-spacing-y" value="600">
                            </div>
                        </div>
                        
                        <div class="action-row">
                            <button class="primary-btn" onclick="createGridLayout()">
                                <i class="fas fa-th"></i> Grid
                            </button>
                            <button class="secondary-btn" onclick="createStaggeredLayout()">
                                <i class="fas fa-th-large"></i> Staggered
                            </button>
                            <button class="accent-btn" onclick="optimizeLayout()">
                                <i class="fas fa-magic"></i> Optimitzar GA
                            </button>
                        </div>
                        
                        <div class="canvas-container">
                            <canvas id="layoutCanvas" width="800" height="500"></canvas>
                        </div>
                    </div>
                </section>

                <!-- RESULTS TAB -->
                <section id="tab-results" class="tab-content">
                    <h2><i class="fas fa-chart-bar"></i> Resultats</h2>
                    
                    <div class="results-grid">
                        <div class="stat-card glass">
                            <div class="stat-icon"><i class="fas fa-bolt"></i></div>
                            <div class="stat-content">
                                <h3>Capacitat Total</h3>
                                <p class="stat-value" id="stat-capacity">--<span class="unit">MW</span></p>
                            </div>
                        </div>
                        
                        <div class="stat-card glass">
                            <div class="stat-icon"><i class="fas fa-energy"></i></div>
                            <div class="stat-content">
                                <h3>AEP Brut</h3>
                                <p class="stat-value" id="stat-aep">--<span class="unit">GWh/any</span></p>
                            </div>
                        </div>
                        
                        <div class="stat-card glass">
                            <div class="stat-icon"><i class="fas fa-wind"></i></div>
                            <div class="stat-content">
                                <h3>Pèrdues Wake</h3>
                                <p class="stat-value" id="stat-wake">--<span class="unit">%</span></p>
                            </div>
                        </div>
                        
                        <div class="stat-card glass">
                            <div class="stat-icon"><i class="fas fa-tachometer-alt"></i></div>
                            <div class="stat-content">
                                <h3>Disponibilitat</h3>
                                <p class="stat-value">97<span class="unit">%</span></p>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Modal: New Project -->
    <div id="modal-new-project" class="modal hidden">
        <div class="modal-content glass">
            <div class="modal-header">
                <h2><i class="fas fa-plus"></i> Nou Projecte</h2>
                <button class="modal-close" onclick="closeNewProjectModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="input-group">
                    <label>Nom del projecte *</label>
                    <input type="text" id="new-project-name" placeholder="Ex: Parc Eòlic Barcelona">
                </div>
                <div class="input-group">
                    <label>Descripció</label>
                    <textarea id="new-project-desc" placeholder="Descripció del projecte..."></textarea>
                </div>
                <div class="input-group">
                    <label>Autor</label>
                    <input type="text" id="new-project-author" placeholder="El teu nom">
                </div>
            </div>
            <div class="modal-footer">
                <button class="secondary-btn" onclick="closeNewProjectModal()">Cancel·lar</button>
                <button class="primary-btn" onclick="createNewProject()">
                    <i class="fas fa-plus"></i> Crear Projecte
                </button>
            </div>
        </div>
    </div>

    <!-- Modal: Open Project -->
    <div id="modal-open-project" class="modal hidden">
        <div class="modal-content glass">
            <div class="modal-header">
                <h2><i class="fas fa-folder-open"></i> Obrir Projecte</h2>
                <button class="modal-close" onclick="closeOpenProjectModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="project-list" id="all-projects-list">
                    <p class="placeholder">Carregant projectes...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container"></div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="hidden">
        <div class="loader">
            <div class="loader-ring"></div>
            <p>Processant...</p>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
